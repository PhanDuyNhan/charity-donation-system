version: '3.8'

networks:
  charity_net:
    driver: bridge

services:
  postgrest:
    image: postgrest/postgrest:v12.0.2
    container_name: postgrest_api
    restart: always
    ports:
      - "3000:3000"
    networks:
      - charity_net
    environment:
      # --- DATABASE ---
      PGRST_DB_URI: "postgres://super_admin:j2ee@postgre.oshi.id.vn:5432/charity_db_v2"
      PGRST_DB_SCHEMAS: "public"
      PGRST_DB_ANON_ROLE: "super_admin"
      PGRST_SERVER_HOST: "0.0.0.0"

      # --- JWT SECRET ---
      PGRST_JWT_SECRET: "secret_keysecret_keysecret_keysecret_keysecret_key"
  
      # --- OPENAPI URL ---
      PGRST_OPENAPI_SERVER_PROXY_URI: "https://j2ee.oshi.id.vn/api/v1"

      # --- ✅ BẬT CORS ---
      PGRST_SERVER_CORS_ENABLED: "true"                # ⚡ Bắt buộc để bật CORS
        #PGRST_SERVER_CORS_ALLOWED_ORIGINS: "*"           # Cho phép mọi domain (dev)
      # Hoặc chỉ cho phép 1 domain cụ thể (production):
      PGRST_SERVER_CORS_ALLOWED_ORIGINS: "https://j2ee.oshi.id.vn"